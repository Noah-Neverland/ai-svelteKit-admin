# 01-示意图-基础架构

## 实现步骤：第一步 - 基础架构和工具层

### 1.1 项目初始化结构

```
ai-svelteKit-admin/
├── src/
│   ├── lib/
│   │   ├── api/              # API请求层
│   │   ├── utils/            # 工具函数
│   │   ├── types/            # 类型定义
│   │   ├── config/           # 配置文件
│   │   └── constants/        # 常量定义
│   └── hooks/                # SvelteKit hooks
```

### 1.2 HTTP请求封装架构

```
┌─────────────────────────────────────────────────┐
│              API Client (Axios)                 │
├─────────────────────────────────────────────────┤
│                                                 │
│  ┌──────────────────────────────────────────┐  │
│  │      Request Interceptor (请求拦截器)     │  │
│  │  • 添加 Authorization Token              │  │
│  │  • 添加语言标识 Header                    │  │
│  │  • 添加请求时间戳                         │  │
│  └──────────────────────────────────────────┘  │
│                    ↓                            │
│  ┌──────────────────────────────────────────┐  │
│  │         HTTP Request (发送请求)          │  │
│  └──────────────────────────────────────────┘  │
│                    ↓                            │
│  ┌──────────────────────────────────────────┐  │
│  │   Response Interceptor (响应拦截器)       │  │
│  │  • 统一处理响应数据格式                   │  │
│  │  • 401 未授权 → 跳转登录页                │  │
│  │  • 403 无权限 → 显示权限不足提示          │  │
│  │  • 其他错误 → 统一错误处理                │  │
│  └──────────────────────────────────────────┘  │
│                    ↓                            │
│  ┌──────────────────────────────────────────┐  │
│  │         Error Handler (错误处理)          │  │
│  │  • 网络错误处理                           │  │
│  │  • HTTP状态码错误处理                     │  │
│  │  • 业务错误处理                           │  │
│  │  • 错误信息国际化                         │  │
│  └──────────────────────────────────────────┘  │
│                                                 │
└─────────────────────────────────────────────────┘
```

### 1.3 工具函数模块结构

```
┌─────────────────────────────────────────────────┐
│               Utils (工具函数层)                  │
├─────────────────────────────────────────────────┤
│                                                 │
│  ┌──────────────┐  ┌──────────────┐            │
│  │  storage.ts  │  │ validation.ts│            │
│  │  • get()     │  │ • email()    │            │
│  │  • set()     │  │ • password() │            │
│  │  • remove()  │  │ • phone()    │            │
│  │  • clear()   │  └──────────────┘            │
│  └──────────────┘                              │
│                                                 │
│  ┌──────────────┐  ┌──────────────┐            │
│  │   date.ts   │  │  format.ts   │            │
│  │  • format() │  │ • currency() │            │
│  │  • parse()  │  │ • number()   │            │
│  │  • diff()   │  │ • percent()  │            │
│  └──────────────┘  └──────────────┘            │
│                                                 │
│  ┌──────────────┐  ┌──────────────┐            │
│  │permission.ts│  │  router.ts   │            │
│  │ • hasRole() │  │ • goto()     │            │
│  │ • hasPerm() │  │ • breadcrumb()│           │
│  └──────────────┘  └──────────────┘            │
│                                                 │
│  ┌──────────────┐                              │
│  │   file.ts   │                              │
│  │ • upload()  │                              │
│  │ • download()│                              │
│  └──────────────┘                              │
│                                                 │
└─────────────────────────────────────────────────┘
```

### 1.4 类型定义结构

```
┌─────────────────────────────────────────────────┐
│              Types (类型定义层)                   │
├─────────────────────────────────────────────────┤
│                                                 │
│  ┌──────────────────────────────────────────┐  │
│  │         common.types.ts                  │  │
│  │  • ApiResponse<T>                        │  │
│  │  • PaginationParams                     │  │
│  │  • BaseEntity                           │  │
│  └──────────────────────────────────────────┘  │
│                                                 │
│  ┌──────────────────────────────────────────┐  │
│  │          auth.types.ts                   │  │
│  │  • LoginRequest                          │  │
│  │  • LoginResponse                        │  │
│  │  • RegisterRequest                      │  │
│  └──────────────────────────────────────────┘  │
│                                                 │
│  ┌──────────────────────────────────────────┐  │
│  │          user.types.ts                   │  │
│  │  • User                                  │  │
│  │  • UserRole                              │  │
│  │  • UserPermission                       │  │
│  └──────────────────────────────────────────┘  │
│                                                 │
│  ┌──────────────────────────────────────────┐  │
│  │          menu.types.ts                   │  │
│  │  • MenuItem                              │  │
│  │  • MenuConfig                            │  │
│  └──────────────────────────────────────────┘  │
│                                                 │
│  ┌──────────────────────────────────────────┐  │
│  │         api.types.ts                     │  │
│  │  • ApiError                              │  │
│  │  • RequestConfig                        │  │
│  └──────────────────────────────────────────┘  │
│                                                 │
└─────────────────────────────────────────────────┘
```

### 1.5 配置文件结构

```
┌─────────────────────────────────────────────────┐
│              Config (配置层)                    │
├─────────────────────────────────────────────────┤
│                                                 │
│  ┌──────────────────────────────────────────┐  │
│  │         app.config.ts                    │  │
│  │  • APP_NAME                              │  │
│  │  • APP_VERSION                           │  │
│  │  • MENU_SOURCE (server|local)            │  │
│  └──────────────────────────────────────────┘  │
│                                                 │
│  ┌──────────────────────────────────────────┐  │
│  │         api.config.ts                    │  │
│  │  • BASE_URL                              │  │
│  │  • TIMEOUT                               │  │
│  │  • RETRY_COUNT                           │  │
│  └──────────────────────────────────────────┘  │
│                                                 │
│  ┌──────────────────────────────────────────┐  │
│  │        theme.config.ts                   │  │
│  │  • THEME_COLORS                          │  │
│  │  • DEFAULT_THEME                         │  │
│  └──────────────────────────────────────────┘  │
│                                                 │
└─────────────────────────────────────────────────┘
```

### 1.6 常量定义结构

```
┌─────────────────────────────────────────────────┐
│            Constants (常量层)                    │
├─────────────────────────────────────────────────┤
│                                                 │
│  ┌──────────────────────────────────────────┐  │
│  │           routes.ts                      │  │
│  │  • ROUTE_LOGIN = '/login'                │  │
│  │  • ROUTE_DASHBOARD = '/'                 │  │
│  └──────────────────────────────────────────┘  │
│                                                 │
│  ┌──────────────────────────────────────────┐  │
│  │            roles.ts                      │  │
│  │  • ROLE_SUPER_ADMIN                      │  │
│  │  • ROLE_ADMIN                            │  │
│  │  • ROLE_USER                             │  │
│  └──────────────────────────────────────────┘  │
│                                                 │
│  ┌──────────────────────────────────────────┐  │
│  │        permissions.ts                    │  │
│  │  • PERM_READ                             │  │
│  │  • PERM_WRITE                            │  │
│  │  • PERM_DELETE                           │  │
│  └──────────────────────────────────────────┘  │
│                                                 │
└─────────────────────────────────────────────────┘
```

### 1.7 实现顺序

```
步骤1: 创建项目基础结构
  ├─ 初始化 SvelteKit 项目
  ├─ 配置 TypeScript
  ├─ 配置 Tailwind CSS
  └─ 配置 shadcn-svelte

步骤2: 实现工具函数层
  ├─ storage.ts (本地存储封装)
  ├─ validation.ts (数据验证)
  ├─ format.ts (数据格式化)
  ├─ date.ts (日期处理)
  ├─ permission.ts (权限判断)
  ├─ router.ts (路由工具)
  └─ file.ts (文件处理)

步骤3: 实现类型定义
  ├─ common.types.ts
  ├─ auth.types.ts
  ├─ user.types.ts
  ├─ menu.types.ts
  └─ api.types.ts

步骤4: 实现配置文件
  ├─ app.config.ts
  ├─ api.config.ts
  └─ theme.config.ts

步骤5: 实现常量定义
  ├─ routes.ts
  ├─ roles.ts
  └─ permissions.ts

步骤6: 实现 HTTP 请求封装
  ├─ api/client.ts (Axios实例)
  ├─ api/interceptors.ts (拦截器)
  └─ api/types.ts (API类型)
```

---

**说明**：这是第一步，建立项目的基础架构和工具层，为后续功能开发提供支撑。

